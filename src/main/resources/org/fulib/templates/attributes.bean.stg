import "attributes.pojo.stg"

// --------------- Simple Accessors ---------------

attrSet(attr) ::= <<
   public <attr.clazz.name> set<attr.name; format="cap">(<attr.type> value)
   {
      if (<if(attr.primitive)>value == this.<attr.name><else>Objects.equals(value, this.<attr.name>)<endif>)
      {
         return this;
      }

      final <attr.type> oldValue = this.<attr.name>;
      this.<attr.name> = value;
      this.firePropertyChange(PROPERTY_<attr.name>, oldValue, value);
      return this;
   }
>>

// --------------- With ---------------

attrWithItem(attr) ::= <<
   public <attr.clazz.name> with<attr.name; format="cap">(<box(attr)> value)
   {
      if (this.<attr.name> == null)
      {
         this.<attr.name> = new <collectionImpl(attr)>();
      }
      if (this.<attr.name>.add(value))<! the collection could be a set, in which case we don't want a PCE!>
      {
         this.firePropertyChange(PROPERTY_<attr.name>, null, value);
      }
      return this;
   }
>>

attrWithArray(attr) ::= <<
   public <attr.clazz.name> with<attr.name; format="cap">(<box(attr)>... value)
   {
      for (final <attr.type> item : value)
      {
         this.with<attr.name; format="cap">(item);
      }
      return this;
   }
>>

attrWithColl(attr) ::= <<
   public <attr.clazz.name> with<attr.name; format="cap">(Collection\<? extends <box(attr)>\> value)
   {
      for (final <box(attr)> item : value)
      {
         this.with<attr.name; format="cap">(item);
      }
      return this;
   }
>>

// --------------- Without ---------------

attrWithoutItem(attr) ::= <<
   public <attr.clazz.name> without<attr.name; format="cap">(<box(attr)> value)
   {
      if (this.<attr.name> != null && this.<attr.name>.removeAll(Collections.singleton(value)))
      {
         this.firePropertyChange(PROPERTY_<attr.name>, value, null);
      }
      return this;
   }
>>

attrWithoutArray(attr) ::= <<
   public <attr.clazz.name> without<attr.name; format="cap">(<box(attr)>... value)
   {
      for (final <box(attr)> item : value)
      {
         this.without<attr.name; format="cap">(item);
      }
      return this;
   }
>>

attrWithoutColl(attr) ::= <<
   public <attr.clazz.name> without<attr.name; format="cap">(Collection\<? extends <box(attr)>\> value)
   {
      for (final <box(attr)> item : value)
      {
         this.without<attr.name; format="cap">(item);
      }
      return this;
   }
>>

// --------------- Set All ---------------

attrSetAllArray(attr) ::= <<
   public <attr.clazz.name> set<attr.name; format="cap">(<box(attr)>... value)
   {
      return this.set<attr.name; format="cap">(Arrays.asList(value));
   }
>>

attrSetAllColl(attr) ::= <<
   public <attr.clazz.name> set<attr.name; format="cap">(Collection\<? extends <box(attr)>\> value)
   {
      if (this.<attr.name> == null)
      {
         this.<attr.name> = new <collectionImpl(attr)>(value);
         for (final <box(attr)> newItem : value)
         {
            this.firePropertyChange(PROPERTY_<attr.name>, null, newItem);
         }
         return this;
      }

      if (value.equals(this.<attr.name>))
      {
         return this;
      }

      for (final <box(attr)> oldItem : this.<attr.name>)
      {
         if (!value.contains(oldItem))
         {
            this.firePropertyChange(PROPERTY_<attr.name>, oldItem, null);
         }
      }

      for (final <box(attr)> newItem : value)
      {
         if (!this.<attr.name>.contains(newItem))
         {
            this.firePropertyChange(PROPERTY_<attr.name>, null, newItem);
         }
      }

      this.<attr.name>.clear();
      this.<attr.name>.addAll(value);
      return this;
   }
>>
